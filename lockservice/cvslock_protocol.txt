Initial connection string.  Server sends greeting with version number:

CVSLock 1.0 Ready

Commands are:

Login mode   1.0
Client <user>'|'<root>['|'<client_host>]

Register a lock client.  This must be done before any other commands (except monitor) are
executed.

Client mode   1.0
Lock {Read|Write} [Recursive] {File|Directory}'|'<path>

Start a lock on a file or directory.

Client mode   1.0
Unlock <path>

Terminate a lock.   This is also called implicitly if you break connection to the lockserver

Login mode   1.0
monitor

Monitor activity.

State is sent to the client in the following format:

Login/Out: 010 MONITOR Client (client) server|client|user|root|state
Lock:      010 MONITOR Lock (client) Path|Flags  
Unlock:    010 MONITOR Lock (client) Path|Deleted 

Monitor mode   1.0
Clients

(monitor mode only) List current lockserver clients.  Results are in the following format:

(client) server|client|user|root|state


Error returns:

000 OK {message}
001 FAIL {message}
002 WAIT {message}
010 MONITOR {message}


-------------------------------
protocol 1.1 extensions

client mode  1.1
BeginTransaction

Return transaction ID for this session.  Ensure the client has a frozen image of the
repository for the duration of the transaction.

returns:

000 OK ID=<transaction ID> {message}

client mode 1.1
EndTransaction 

Finished transaction.  Called implicitly on client disconnect.

client mode 1.1
GetVersion <file> <branch>

Get version for active transaction.  File is relative to repository root.  branch is branch
name or 'HEAD'

client mode 1.1
Modified <type> <file> <branch> <version>

Update version of a file.  This is written into the active transaction map for future clients, but only
made live after an EndTransaction.

Type can be:
Version  - New version committed to branch
Added    - New file added
Deleted  - File deleted.  Not called by current code.
